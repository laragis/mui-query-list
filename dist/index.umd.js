!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("lodash"),require("react"),require("prop-types"),require("@tanstack/react-query"),require("react-intersection-observer"),require("@mui/material"),require("zustand-store-addons"),require("zustand/context"),require("zustand/shallow"),require("immer"),require("react-use"),require("jquery"),require("axios"),require("@mui/lab"),require("scroll-js"),require("numeral")):"function"==typeof define&&define.amd?define(["exports","lodash","react","prop-types","@tanstack/react-query","react-intersection-observer","@mui/material","zustand-store-addons","zustand/context","zustand/shallow","immer","react-use","jquery","axios","@mui/lab","scroll-js","numeral"],t):t((e||self).muiQueryList={},e.lodash,e.react,e.propTypes,e.reactQuery,e.reactIntersectionObserver,e.material,e.zustandStoreAddons,e.createContext,e.shallow,e.immer,e.reactUse,e.jquery,e.axios,e.lab,e.scrollJs,e.numeral)}(this,function(e,t,r,a,n,u,l,o,i,s,c,d,f,m,g,p,y){function v(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var h,E=/*#__PURE__*/v(r),P=/*#__PURE__*/v(a),q=/*#__PURE__*/v(o),w=/*#__PURE__*/v(i),k=/*#__PURE__*/v(s),x=/*#__PURE__*/v(c),b=/*#__PURE__*/v(f),L=/*#__PURE__*/v(m),T=/*#__PURE__*/v(y),N="simple",I="load-more",S="infinite-loading",O=((h={}).simple="Simple",h.links="Links",h.advanced="Advanced",h[I]="Load More",h[S]="Infinite Loading",h);function C(){return C=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},C.apply(this,arguments)}function z(e,t){if(null==e)return{};var r,a,n={},u=Object.keys(e);for(a=0;a<u.length;a++)t.indexOf(r=u[a])>=0||(n[r]=e[r]);return n}var R=function(){return q.default(function(e,t){return{pagination:N,queryKey:[],init:function(t){var r=[t.queryKey,{url:t.url}];console.log(r),e({queryKey:r,pagination:t.pagination,selected:!1})},selected:!1,setSelected:function(t){return e({selected:t})},setPage:function(t){return e(x.default(function(e){e.queryKey[1].params.page=t}))},setPerPage:function(t){return e(x.default(function(e){e.queryKey[1].params.perPage=t}))}}},{computed:{perPage:function(){return t.get(this.queryKey,"1.params.perPage")},page:function(){return t.get(this.queryKey,"1.params.page")}}})},K=w.default(),j=K.Provider,B=function(e,t){return K.useStore.apply(K,F(e,t))},F=function(e,t){if("string"==typeof e){if(-1!==e.indexOf(",")){var r=e.split(",").map(function(e){return e.trim()});return[function(e){return r.map(function(t){return e[t]})},k.default]}return[function(t){return t[e]},t]}return[e,t]},_=function(e){var a=n.useQueryClient(),u=B("queryKey, init"),l=u[0],o=u[1];r.useEffect(function(){!t.isEmpty(l)&&a.cancelQueries(l),o(e)},[JSON.stringify(e.queryKey),e.url,e.page,e.perPage])},A=["url","params"],M=function(e){var r=e.pageParam,a=e.queryKey,n=e.signal;try{var u=a[1],l=u.url,o=u.params,i=(z(u,A),t.isString(l)?C({method:"get",url:l},o):C({params:C({},o,null==l?void 0:l.params)},l));return t.isUndefined(r)||(i.params.page=r),Promise.resolve(L.default(C({signal:n},i))).then(function(e){return e.data})}catch(e){return Promise.reject(e)}};function Q(e){var t=e.meta,r=B("setPage");/*#__PURE__*/return E.default.createElement(l.Pagination,{variant:"outlined",showFirstButton:!0,showLastButton:!0,onChange:function(e,t){return r(t)},count:null==t?void 0:t.last_page,page:null==t?void 0:t.current_page})}function D(e){var a=e.meta,n=e.sizes,u=e.size,o=B("perPage, setPerPage, setPage"),i=o[0],s=o[1],c=o[2],d=null==a?void 0:a.last_page,f=null==a?void 0:a.current_page,m=function(e){var t=parseInt(e.target.value);("Enter"===e.key||"blur"===e.type)&&t>0&&t!==f&&(t<=d?c(t):alert("Not found page "+t))},g=r.useMemo(function(){return t.flow([t.uniq,t.sortBy])(n.concat(u))},[n,u]);return console.log(g),/*#__PURE__*/E.default.createElement(l.Stack,{direction:"row",spacing:2,alignItems:"center",justifyContent:"center"},/*#__PURE__*/E.default.createElement(l.Pagination,{variant:"outlined",showFirstButton:!0,showLastButton:!0,shape:"rounded",onChange:function(e,t){return c(t)},count:d,page:f}),/*#__PURE__*/E.default.createElement(l.TextField,{select:!0,label:"Size",value:i,onChange:function(e){return s(parseInt(e.target.value))},size:"small",style:{width:110}},g.map(function(e,t){/*#__PURE__*/return E.default.createElement(l.MenuItem,{key:t,value:e,defaultValue:!0},e," / page")})),/*#__PURE__*/E.default.createElement(l.Typography,null,"Go to"),/*#__PURE__*/E.default.createElement(l.TextField,{label:"Page",variant:"outlined",onKeyUp:m,onBlur:m,size:"small",type:"number",style:{width:85}}))}D.defaultProps={sizes:[10,20,50,100,200]};var U,V=["page","type","selected"];function G(e){var a,n=B("pagination"),u="function"==typeof(a=n)&&r.isValidElement(a())?n:t.get(G.types,n,Q);/*#__PURE__*/return E.default.createElement(u,e)}G.propTypes={type:P.default.oneOfType([P.default.string,P.default.func])},G.types=((U={}).simple=Q,U.links=function(e){var r=e.meta,a=B("setPage"),n=g.usePagination({count:null==r?void 0:r.last_page,onChange:function(e,t){return a(t)}}),u=t.filter(n.items,function(e){return t.includes(["previous","next"],e.type)});/*#__PURE__*/return E.default.createElement("nav",null,/*#__PURE__*/E.default.createElement(l.List,null,u.map(function(e,t){var r=e.type,a=z(e,V);/*#__PURE__*/return E.default.createElement(l.Button,C({type:"button"},a,{key:t}),r)})))},U.advanced=D,U[I]=function(e){var t=e.queryInfo||{},r=t.isFetchingNextPage,a=t.fetchNextPage,n=t.hasNextPage;return n?/*#__PURE__*/E.default.createElement(l.Button,{variant:"outlined",onClick:function(){return a()},disabled:!n||r},r?"Loading more...":"Load More"):"Nothing more to load"},U[S]=function(e){var t=e.threshold,r=e.queryInfo||{},a=r.isFetchingNextPage,n=r.fetchNextPage,o=r.hasNextPage;return o?a?/*#__PURE__*/E.default.createElement(l.LinearProgress,{className:"w-full mt-12",color:"secondary"}):t?null:/*#__PURE__*/E.default.createElement(l.Stack,{alignItems:"center"},/*#__PURE__*/E.default.createElement(u.InView,{as:l.Button,onClick:function(){return n()},disabled:!o||a,onChange:function(e){return e&&o&&n()}},"Load More")):"Nothing more to load"},U);var J=r.forwardRef(function(e,a){var o,i,s=e.renderListItem,c=e.renderList,d=e.wrapperListItem,f=e.onRowClicked,m=B("queryKey, selected, setSelected"),g=m[1],y=m[2],v=n.useInfiniteQuery(m[0],M,{getPreviousPageParam:function(e,t){var r=e.meta.current_page-1;return r>0?r:void 0},getNextPageParam:function(e,t){var r=e.meta.current_page+1;return r<=e.meta.last_page?r:void 0}}),h=v.status,P=v.data,q=v.error,w=v.isFetching,k=v.isFetchingNextPage,x=v.isFetchingPreviousPage,b=v.fetchNextPage,L=v.fetchPreviousPage,T=v.hasNextPage,N=v.hasPreviousPage;_(e);var I=r.useMemo(function(){return t.get(P,"pages.0.data.0")},[t.get(P,"pages.0.data.0")]);return r.useEffect(function(){},[]),/*#__PURE__*/E.default.createElement("div",null,"loading"===h?/*#__PURE__*/E.default.createElement(l.LinearProgress,{className:"w-full",color:"primary"}):"error"===h?/*#__PURE__*/E.default.createElement("span",null,"Error: ",q.message):/*#__PURE__*/E.default.createElement(r.Fragment,null,e.page>1&&/*#__PURE__*/E.default.createElement(l.Button,{className:"mb-6",onClick:function(){return L()},disabled:!N||x},x?"Loading more...":N?"Load Older":"Nothing more to load"),/*#__PURE__*/E.default.createElement(c,{meta:null==P?void 0:P.meta,firstRow:I,aaa:123},null==(o=P.pages)?void 0:o.map(function(a,n){/*#__PURE__*/return E.default.createElement(r.Fragment,{key:n},a.data.map(function(r,o){var i=o+a.meta.from,c={serial:i,data:r,meta:a.meta,onRowClicked:function(e,t){var r=g!==i&&i;y(r),f(e,{item:t,selected:r})},selected:i===g,setSelected:y};return d?/*#__PURE__*/E.default.createElement(l.Box,{key:o,component:e.pagination===S&&e.threshold&&e.threshold>0&&e.threshold<=a.data.length&&a.data.length-e.threshold===o+1?u.InView:l.Box,onChange:function(e,r){return function(e,r,a){e&&T&&!t.has(P,["pages",a+1])&&b()}(e,0,n)}},/*#__PURE__*/E.default.createElement(s,c)):/*#__PURE__*/E.default.createElement(s,C({key:o},c))}))})),e.backToTop&&(null==(i=e.scrollPosition)?void 0:i.y)>400&&/*#__PURE__*/E.default.createElement(l.Button,{onClick:function(){p.scrollTo(document.querySelector(e.scrollTarget)||window,{top:0,duration:200})},className:"fixed",sx:{bottom:90,right:100,zIndex:100},variant:"outlined"},/*#__PURE__*/E.default.createElement("i",{className:"fa-solid fa-arrow-up-to-line mr-10"}),"Back to top"),/*#__PURE__*/E.default.createElement(l.Stack,{direction:"row",justifyContent:"center"},/*#__PURE__*/E.default.createElement(G,{queryInfo:v,data:P,threshold:e.threshold})),w&&!k?/*#__PURE__*/E.default.createElement(l.Stack,{className:"mt-6",alignItems:"center",spacing:1},/*#__PURE__*/E.default.createElement("p",{className:"font-semibold"},"Background Updating..."),/*#__PURE__*/E.default.createElement(l.LinearProgress,{className:"w-full",color:"primary"})):null))});J.defaultProps={wrapperListItem:!0};var Y=J;function X(e){var a,u=e.renderListItem,o=e.renderList,i=e.onRowClicked,s=B("queryKey, selected, setSelected"),c=s[1],f=s[2],m=n.useQuery(s[0],M,{keepPreviousData:!0,staleTime:5e3}),g=m.isLoading,p=m.isSuccess,y=m.isFetching,v=m.error,h=m.data;_(e),d.useUpdateEffect(function(){b.default(e.scrollTarget||window).scrollTop(0)},[h]);var P=r.useMemo(function(){return t.get(h,"data.0")},[t.get(h,"data.0")]);/*#__PURE__*/return E.default.createElement(l.Stack,{spacing:1.5},g&&/*#__PURE__*/E.default.createElement(l.LinearProgress,null),(null==v?void 0:v.message)&&/*#__PURE__*/E.default.createElement(l.Alert,{variant:"filled",severity:"error"},null==v?void 0:v.message),p&&/*#__PURE__*/E.default.createElement(r.Fragment,null,/*#__PURE__*/E.default.createElement(o,{meta:null==h?void 0:h.meta,firstRow:P},null==h||null==(a=h.data)?void 0:a.map(function(e,t){var r=h.meta.from+t;/*#__PURE__*/return E.default.createElement(u,{key:t,serial:h.meta.from+t,data:e,meta:null==h?void 0:h.meta,onRowClicked:function(t,a){var n=c!==r&&r;f(n),i(t,{item:e,selected:n})}})})),y&&/*#__PURE__*/E.default.createElement(l.LinearProgress,null)),(null==h?void 0:h.meta)&&/*#__PURE__*/E.default.createElement(G,{meta:h.meta,size:e.perPage,sizes:e.sizes}))}function H(e,t){return void 0===t&&(t="0,0"),T.default(e).format(t)}var W=["children","meta"],Z=r.forwardRef(function(e,a){var n=function(e){var a=e.scrollTarget,n=e.scrollIndex,u=e.wait,l=void 0===u?300:u,o=r.useRef(),i=d.useRafState({x:0,y:0}),s=i[0],c=i[1],f=r.useCallback(function(e){var t=a?{x:"scrollLeft",y:"scrollTop"}:{x:"pageXOffset",y:"pageYOffset"};c({x:o.current[t.x],y:o.current[t.y]})},[a]);return r.useEffect(function(){return o.current=a?document.querySelector(a):window,o.current.addEventListener("scroll",t.debounce(f,l)),function(){o.current.removeEventListener("scroll",f)}},[]),r.useEffect(function(){setTimeout(function(){scrollTo(b.default(a).get(0))},1e3)},[n]),s}(e),u=C({},e,{scrollPosition:n});/*#__PURE__*/return E.default.createElement(j,{createStore:R},t.includes([I,S],e.pagination)?/*#__PURE__*/E.default.createElement(Y,C({ref:a},u)):/*#__PURE__*/E.default.createElement(X,C({ref:a},u)))});Z.propTypes={queryKey:P.default.oneOfType([P.default.string,P.default.array]),url:P.default.oneOfType([P.default.string,P.default.object]),pagination:P.default.oneOfType([P.default.string,P.default.func]),page:P.default.oneOfType([P.default.string,P.default.number]),perPage:P.default.oneOfType([P.default.string,P.default.number]),select:P.default.func,threshold:P.default.number,scrollTop:P.default.bool,scrollTarget:P.default.string},Z.defaultProps={pagination:N,page:1,perPage:10,renderListItem:function(e){/*#__PURE__*/return React.createElement("div",null,e.serial,") ",e.data.id)},renderList:function(e){var t=e.children,r=e.meta;return z(e,W),/*#__PURE__*/React.createElement(l.Stack,{spacing:1},/*#__PURE__*/React.createElement("div",null,"Kết quả từ ",H(r.from),"-",H(r.to)," trong số"," ",H(r.total)),/*#__PURE__*/React.createElement(l.Stack,{spacing:2,divider:/*#__PURE__*/React.createElement(l.Divider,{orientation:"horizontal"}),sx:{py:2}},t))},backToTop:!1,onRowClicked:function(){}};var $=Z;e.ADVANCED="advanced",e.INFINITE_LOADING=S,e.LINKS="links",e.LOAD_MORE=I,e.PAGINATION_TYPES=O,e.QueryList=$,e.SIMPLE=N});
//# sourceMappingURL=index.umd.js.map
