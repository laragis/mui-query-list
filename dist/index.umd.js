!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("lodash"),require("react"),require("prop-types"),require("@tanstack/react-query"),require("react-intersection-observer"),require("@mui/material"),require("zustand-store-addons"),require("zustand/context"),require("zustand/shallow"),require("immer"),require("react-use"),require("jquery"),require("axios"),require("@mui/lab"),require("scroll-js"),require("numeral")):"function"==typeof define&&define.amd?define(["exports","lodash","react","prop-types","@tanstack/react-query","react-intersection-observer","@mui/material","zustand-store-addons","zustand/context","zustand/shallow","immer","react-use","jquery","axios","@mui/lab","scroll-js","numeral"],t):t((e||self).muiQueryList={},e.lodash,e.react,e.propTypes,e.reactQuery,e.reactIntersectionObserver,e.material,e.zustandStoreAddons,e.createContext,e.shallow,e.immer,e.reactUse,e.jquery,e.axios,e.lab,e.scrollJs,e.numeral)}(this,function(e,t,a,r,n,u,l,o,i,s,c,d,f,m,p,g,y){function v(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var h,E=/*#__PURE__*/v(a),P=/*#__PURE__*/v(r),q=/*#__PURE__*/v(o),w=/*#__PURE__*/v(i),k=/*#__PURE__*/v(s),x=/*#__PURE__*/v(c),b=/*#__PURE__*/v(f),L=/*#__PURE__*/v(m),T=/*#__PURE__*/v(y),I="simple",N="load-more",S="infinite-loading",O=((h={}).simple="Simple",h.links="Links",h.advanced="Advanced",h[N]="Load More",h[S]="Infinite Loading",h);function C(){return C=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},C.apply(this,arguments)}function z(e,t){if(null==e)return{};var a,r,n={},u=Object.keys(e);for(r=0;r<u.length;r++)t.indexOf(a=u[r])>=0||(n[a]=e[a]);return n}var K=function(){return q.default(function(e,a){return{pagination:I,queryKey:[],init:function(a){var r=[t.castArray(a.queryKey)[0],{url:a.url,pagination:a.pagination,params:C({},t.castArray(a.queryKey)[1],{page:a.page>0?a.page:1,perPage:a.perPage>0?a.perPage:20})}];e({queryKey:r,pagination:a.pagination,selected:!1})},selected:!1,setSelected:function(t){return e({selected:t})},setPage:function(t){return e(x.default(function(e){e.queryKey[1].params.page=t}))},setPerPage:function(t){return e(x.default(function(e){e.queryKey[1].params.perPage=t}))}}},{computed:{perPage:function(){return t.get(this.queryKey,"1.params.perPage")},page:function(){return t.get(this.queryKey,"1.params.page")}}})},R=w.default(),j=R.Provider,B=function(e,t){return R.useStore.apply(R,F(e,t))},F=function(e,t){if("string"==typeof e){if(-1!==e.indexOf(",")){var a=e.split(",").map(function(e){return e.trim()});return[function(e){return a.map(function(t){return e[t]})},k.default]}return[function(t){return t[e]},t]}return[e,t]},A=function(e){var r=n.useQueryClient(),u=B("queryKey, init"),l=u[0],o=u[1];a.useEffect(function(){!t.isEmpty(l)&&r.cancelQueries(l),o(e)},[JSON.stringify(e.queryKey),e.url,e.page,e.perPage])},_=["url","params"],M=function(e){var a=e.pageParam,r=e.queryKey,n=e.signal;try{var u=r[1],l=u.url,o=u.params,i=(z(u,_),t.isString(l)?{method:"get",url:l,params:o}:C({params:C({},o,null==l?void 0:l.params)},l));return t.isUndefined(a)||(i.params.page=a),Promise.resolve(L.default(C({signal:n},i))).then(function(e){return e.data})}catch(e){return Promise.reject(e)}};function Q(e){var t=e.meta,a=B("setPage");/*#__PURE__*/return E.default.createElement(l.Pagination,{variant:"outlined",showFirstButton:!0,showLastButton:!0,onChange:function(e,t){return a(t)},count:null==t?void 0:t.last_page,page:null==t?void 0:t.current_page})}function D(e){var r=e.meta,n=e.sizes,u=e.size,o=B("perPage, setPerPage, setPage"),i=o[0],s=o[1],c=o[2],d=null==r?void 0:r.last_page,f=null==r?void 0:r.current_page,m=function(e){var t=parseInt(e.target.value);("Enter"===e.key||"blur"===e.type)&&t>0&&t!==f&&(t<=d?c(t):alert("Not found page "+t))},p=a.useMemo(function(){return t.flow([t.uniq,t.sortBy])(n.concat(u))},[n,u]);return console.log(p),/*#__PURE__*/E.default.createElement(l.Stack,{direction:"row",spacing:2,alignItems:"center",justifyContent:"center"},/*#__PURE__*/E.default.createElement(l.Pagination,{variant:"outlined",showFirstButton:!0,showLastButton:!0,shape:"rounded",onChange:function(e,t){return c(t)},count:d,page:f}),/*#__PURE__*/E.default.createElement(l.TextField,{select:!0,label:"Size",value:i,onChange:function(e){return s(parseInt(e.target.value))},size:"small",style:{width:110}},p.map(function(e,t){/*#__PURE__*/return E.default.createElement(l.MenuItem,{key:t,value:e,defaultValue:!0},e," / page")})),/*#__PURE__*/E.default.createElement(l.Typography,null,"Go to"),/*#__PURE__*/E.default.createElement(l.TextField,{label:"Page",variant:"outlined",onKeyUp:m,onBlur:m,size:"small",type:"number",style:{width:85}}))}D.defaultProps={sizes:[10,20,50,100,200]};var U,V=["page","type","selected"];function G(e){var r,n=B("pagination"),u="function"==typeof(r=n)&&a.isValidElement(r())?n:t.get(G.types,n,Q);/*#__PURE__*/return E.default.createElement(u,e)}G.propTypes={type:P.default.oneOfType([P.default.string,P.default.func])},G.types=((U={}).simple=Q,U.links=function(e){var a=e.meta,r=B("setPage"),n=p.usePagination({count:null==a?void 0:a.last_page,onChange:function(e,t){return r(t)}}),u=t.filter(n.items,function(e){return t.includes(["previous","next"],e.type)});/*#__PURE__*/return E.default.createElement("nav",null,/*#__PURE__*/E.default.createElement(l.List,null,u.map(function(e,t){var a=e.type,r=z(e,V);/*#__PURE__*/return E.default.createElement(l.Button,C({type:"button"},r,{key:t}),a)})))},U.advanced=D,U[N]=function(e){var t=e.queryInfo||{},a=t.isFetchingNextPage,r=t.fetchNextPage,n=t.hasNextPage;return n?/*#__PURE__*/E.default.createElement(l.Button,{variant:"outlined",onClick:function(){return r()},disabled:!n||a},a?"Loading more...":"Load More"):"Nothing more to load"},U[S]=function(e){var t=e.threshold,a=e.queryInfo||{},r=a.isFetchingNextPage,n=a.fetchNextPage,o=a.hasNextPage;return o?r?/*#__PURE__*/E.default.createElement(l.LinearProgress,{className:"w-full mt-12",color:"secondary"}):t?null:/*#__PURE__*/E.default.createElement(l.Stack,{alignItems:"center"},/*#__PURE__*/E.default.createElement(u.InView,{as:l.Button,onClick:function(){return n()},disabled:!o||r,onChange:function(e){return e&&o&&n()}},"Load More")):""},U);var J=a.forwardRef(function(e,r){var o,i,s=e.renderListItem,c=e.renderList,d=e.wrapperListItem,f=e.onRowClicked,m=B("queryKey, selected, setSelected"),p=m[1],y=m[2],v=n.useInfiniteQuery(m[0],M,{getPreviousPageParam:function(e,t){var a=e.meta.current_page-1;return a>0?a:void 0},getNextPageParam:function(e,t){var a=e.meta.current_page+1;return a<=e.meta.last_page?a:void 0}}),h=v.status,P=v.data,q=v.error,w=v.isFetching,k=v.isFetchingNextPage,x=v.isFetchingPreviousPage,b=v.fetchNextPage,L=v.fetchPreviousPage,T=v.hasNextPage,I=v.hasPreviousPage;A(e);var N=a.useMemo(function(){return t.get(P,"pages.0.data.0")},[t.get(P,"pages.0.data.0")]),O=t.last((null==P?void 0:P.pages)||[]),z=a.useMemo(function(){return C({},t.get(O,"meta"))},[O]);/*#__PURE__*/return E.default.createElement("div",null,"loading"===h?/*#__PURE__*/E.default.createElement(l.LinearProgress,{className:"w-full",color:"primary"}):"error"===h?/*#__PURE__*/E.default.createElement("span",null,"Error: ",q.message):/*#__PURE__*/E.default.createElement(a.Fragment,null,e.page>1&&/*#__PURE__*/E.default.createElement(l.Button,{className:"mb-6",onClick:function(){return L()},disabled:!I||x},x?"Loading more...":I?"Load Older":"Nothing more to load"),/*#__PURE__*/E.default.createElement(c,{meta:z,firstRow:N},null==(o=P.pages)?void 0:o.map(function(r,n){/*#__PURE__*/return E.default.createElement(a.Fragment,{key:n},r.data.map(function(a,o){var i=o+r.meta.from,c={serial:i,data:a,meta:r.meta,onRowClicked:function(e,t){var a=p!==i&&i;y(a),f(e,{item:t,selected:a})},selected:i===p,setSelected:y};return d?/*#__PURE__*/E.default.createElement(l.Box,{key:o,component:e.pagination===S&&e.threshold&&e.threshold>0&&e.threshold<=r.data.length&&r.data.length-e.threshold===o+1?u.InView:l.Box,onChange:function(e,a){return function(e,a,r){e&&T&&!t.has(P,["pages",r+1])&&b()}(e,0,n)}},/*#__PURE__*/E.default.createElement(s,c)):/*#__PURE__*/E.default.createElement(s,C({key:o},c))}))})),e.backToTop&&(null==(i=e.scrollPosition)?void 0:i.y)>400&&/*#__PURE__*/E.default.createElement(l.Button,{onClick:function(){g.scrollTo(document.querySelector(e.scrollTarget)||window,{top:0,duration:200})},className:"fixed",sx:{bottom:90,right:100,zIndex:100},variant:"outlined"},/*#__PURE__*/E.default.createElement("i",{className:"fa-solid fa-arrow-up-to-line mr-10"}),"Back to top"),/*#__PURE__*/E.default.createElement(l.Stack,{direction:"row",justifyContent:"center"},/*#__PURE__*/E.default.createElement(G,{queryInfo:v,data:P,threshold:e.threshold})),w&&!k?/*#__PURE__*/E.default.createElement(l.Stack,{className:"mt-6",alignItems:"center",spacing:1},/*#__PURE__*/E.default.createElement("p",{className:"font-semibold"},"Background Updating..."),/*#__PURE__*/E.default.createElement(l.LinearProgress,{className:"w-full",color:"primary"})):null))});J.defaultProps={wrapperListItem:!0};var Y=J;function X(e){var r,u=e.renderListItem,o=e.renderList,i=e.onRowClicked,s=B("queryKey, selected, setSelected"),c=s[1],f=s[2],m=n.useQuery(s[0],M,{keepPreviousData:!0,staleTime:5e3}),p=m.isLoading,g=m.isSuccess,y=m.isFetching,v=m.error,h=m.data;A(e),d.useUpdateEffect(function(){b.default(e.scrollTarget||window).scrollTop(0)},[h]);var P=a.useMemo(function(){return t.get(h,"data.0")},[t.get(h,"data.0")]);/*#__PURE__*/return E.default.createElement(l.Stack,{spacing:1.5},p&&/*#__PURE__*/E.default.createElement(l.LinearProgress,null),(null==v?void 0:v.message)&&/*#__PURE__*/E.default.createElement(l.Alert,{variant:"filled",severity:"error"},null==v?void 0:v.message),g&&/*#__PURE__*/E.default.createElement(a.Fragment,null,/*#__PURE__*/E.default.createElement(o,{meta:null==h?void 0:h.meta,firstRow:P},null==h||null==(r=h.data)?void 0:r.map(function(e,t){var a=h.meta.from+t;/*#__PURE__*/return E.default.createElement(u,{key:t,serial:h.meta.from+t,data:e,meta:null==h?void 0:h.meta,onRowClicked:function(t,r){var n=c!==a&&a;f(n),i(t,{item:e,selected:n})}})})),y&&/*#__PURE__*/E.default.createElement(l.LinearProgress,null)),(null==h?void 0:h.meta)&&/*#__PURE__*/E.default.createElement(G,{meta:h.meta,size:e.perPage,sizes:e.sizes}))}function H(e,t){return void 0===t&&(t="0,0"),T.default(e).format(t)}var W=["children","meta"],Z=a.forwardRef(function(e,r){var n=function(e){var r=e.scrollTarget,n=e.scrollIndex,u=e.wait,l=void 0===u?300:u,o=a.useRef(),i=d.useRafState({x:0,y:0}),s=i[0],c=i[1],f=a.useCallback(function(e){var t=r?{x:"scrollLeft",y:"scrollTop"}:{x:"pageXOffset",y:"pageYOffset"};c({x:o.current[t.x],y:o.current[t.y]})},[r]);return a.useEffect(function(){return o.current=r?document.querySelector(r):window,o.current.addEventListener("scroll",t.debounce(f,l)),function(){o.current.removeEventListener("scroll",f)}},[]),a.useEffect(function(){setTimeout(function(){scrollTo(b.default(r).get(0))},1e3)},[n]),s}(e),u=C({},e,{scrollPosition:n});/*#__PURE__*/return E.default.createElement(j,{createStore:K},t.includes([N,S],e.pagination)?/*#__PURE__*/E.default.createElement(Y,C({ref:r},u)):/*#__PURE__*/E.default.createElement(X,C({ref:r},u)))});Z.propTypes={queryKey:P.default.oneOfType([P.default.string,P.default.array]),url:P.default.oneOfType([P.default.string,P.default.object]),pagination:P.default.oneOfType([P.default.string,P.default.func]),page:P.default.oneOfType([P.default.string,P.default.number]),perPage:P.default.oneOfType([P.default.string,P.default.number]),select:P.default.func,threshold:P.default.number,scrollTop:P.default.bool,scrollTarget:P.default.string},Z.defaultProps={pagination:I,page:1,perPage:10,renderListItem:function(e){/*#__PURE__*/return React.createElement("div",null,e.serial,") ",e.data.id)},renderList:function(e){var t=e.children,a=e.meta;return z(e,W),/*#__PURE__*/React.createElement(l.Stack,{spacing:1},/*#__PURE__*/React.createElement("div",null,"Kết quả từ ",H(a.from),"-",H(a.to)," trong số"," ",H(a.total)),/*#__PURE__*/React.createElement(l.Stack,{spacing:2,divider:/*#__PURE__*/React.createElement(l.Divider,{orientation:"horizontal"}),sx:{py:2}},t))},backToTop:!1,onRowClicked:function(){}};var $=Z;e.ADVANCED="advanced",e.INFINITE_LOADING=S,e.LINKS="links",e.LOAD_MORE=N,e.PAGINATION_TYPES=O,e.QueryList=$,e.SIMPLE=I});
//# sourceMappingURL=index.umd.js.map
