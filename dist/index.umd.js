!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("lodash"),require("react"),require("prop-types"),require("@tanstack/react-query"),require("react-intersection-observer"),require("@mui/material"),require("zustand-store-addons"),require("zustand/context"),require("zustand/shallow"),require("immer"),require("react-use"),require("jquery"),require("axios"),require("@mui/lab"),require("scroll-js"),require("numeral")):"function"==typeof define&&define.amd?define(["exports","lodash","react","prop-types","@tanstack/react-query","react-intersection-observer","@mui/material","zustand-store-addons","zustand/context","zustand/shallow","immer","react-use","jquery","axios","@mui/lab","scroll-js","numeral"],t):t((e||self).muiQueryList={},e.lodash,e.react,e.propTypes,e.reactQuery,e.reactIntersectionObserver,e.material,e.zustandStoreAddons,e.createContext,e.shallow,e.immer,e.reactUse,e.jquery,e.axios,e.lab,e.scrollJs,e.numeral)}(this,function(e,t,n,a,r,u,l,o,i,s,c,d,f,m,g,p,y){function v(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var h,E=/*#__PURE__*/v(n),P=/*#__PURE__*/v(a),q=/*#__PURE__*/v(o),b=/*#__PURE__*/v(i),x=/*#__PURE__*/v(s),L=/*#__PURE__*/v(c),T=/*#__PURE__*/v(f),k=/*#__PURE__*/v(m),N=/*#__PURE__*/v(y),I="simple",w="load-more",R="infinite-loading",O=((h={}).simple="Simple",h.links="Links",h.advanced="Advanced",h[w]="Load More",h[R]="Infinite Loading",h);function S(){return S=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},S.apply(this,arguments)}function z(e,t){if(null==e)return{};var n,a,r={},u=Object.keys(e);for(a=0;a<u.length;a++)t.indexOf(n=u[a])>=0||(r[n]=e[n]);return r}var C={pagination:I,queryKey:[]},K=function(){return q.default(function(e,t){return S({},C,{init:function(t){e({queryKey:[t.queryKey,{url:t.url,pagination:t.pagination,params:{page:t.page>0?t.page:1,perPage:t.perPage>0?t.perPage:20}}],pagination:t.pagination})},setPage:function(t){return e(L.default(function(e){e.queryKey[1].params.page=t}))},setPerPage:function(t){return e(L.default(function(e){e.queryKey[1].params.perPage=t}))}})},{computed:{perPage:function(){return t.get(this.queryKey,"1.params.perPage")},page:function(){return t.get(this.queryKey,"1.params.page")}}})},j=b.default(),B=j.Provider,F=function(e,t){return j.useStore.apply(j,_(e,t))},_=function(e,t){if("string"==typeof e){if(-1!==e.indexOf(",")){var n=e.split(",").map(function(e){return e.trim()});return[function(e){return n.map(function(t){return e[t]})},x.default]}return[function(t){return t[e]},t]}return[e,t]},A=function(e){var a=r.useQueryClient(),u=F("queryKey, init"),l=u[0],o=u[1];n.useEffect(function(){!t.isEmpty(l)&&a.cancelQueries(l),o(e)},[e.queryKey,e.url,e.page,e.perPage])},M=["url","params"],Q=function(e){var n=e.pageParam,a=e.queryKey,r=e.signal;try{var u=a[1],l=u.url,o=u.params,i=(z(u,M),t.isString(l)?S({method:"get"},o):S({params:S({},o,null==l?void 0:l.params)},l));return t.isUndefined(n)||(i.params.page=n),Promise.resolve(k.default(S({signal:r},i))).then(function(e){return e.data})}catch(e){return Promise.reject(e)}};function D(e){var t=e.meta,n=F("setPage");/*#__PURE__*/return React.createElement(l.Pagination,{variant:"outlined",showFirstButton:!0,showLastButton:!0,onChange:function(e,t){return n(t)},count:null==t?void 0:t.last_page,page:null==t?void 0:t.current_page})}function U(e){var a=e.meta,r=e.sizes,u=e.size,o=F("perPage, setPerPage, setPage"),i=o[0],s=o[1],c=o[2],d=null==a?void 0:a.last_page,f=null==a?void 0:a.current_page,m=function(e){var t=parseInt(e.target.value);("Enter"===e.key||"blur"===e.type)&&t>0&&t!==f&&(t<=d?c(t):alert("Not found page "+t))},g=n.useMemo(function(){return t.flow([t.uniq,t.sortBy])(r.concat(u))},[r,u]);return console.log(g),/*#__PURE__*/E.default.createElement(l.Stack,{direction:"row",spacing:2,alignItems:"center",justifyContent:"center"},/*#__PURE__*/E.default.createElement(l.Pagination,{variant:"outlined",showFirstButton:!0,showLastButton:!0,shape:"rounded",onChange:function(e,t){return c(t)},count:d,page:f}),/*#__PURE__*/E.default.createElement(l.TextField,{select:!0,label:"Size",value:i,onChange:function(e){return s(parseInt(e.target.value))},size:"small",style:{width:110}},g.map(function(e,t){/*#__PURE__*/return E.default.createElement(l.MenuItem,{key:t,value:e,defaultValue:!0},e," / page")})),/*#__PURE__*/E.default.createElement(l.Typography,null,"Go to"),/*#__PURE__*/E.default.createElement(l.TextField,{label:"Page",variant:"outlined",onKeyUp:m,onBlur:m,size:"small",type:"number",style:{width:85}}))}U.defaultProps={sizes:[10,20,50,100,200]};var V,G=["page","type","selected"];function Y(e){var a,r=F("pagination"),u="function"==typeof(a=r)&&n.isValidElement(a())?r:t.get(Y.types,r,D);/*#__PURE__*/return E.default.createElement(u,e)}function J(e){var a,o,i=e.renderListItem,s=e.renderList,c=F("queryKey"),d=r.useInfiniteQuery(c,Q,{getPreviousPageParam:function(e,t){var n=e.meta.current_page-1;return n>0?n:void 0},getNextPageParam:function(e,t){var n=e.meta.current_page+1;return n<=e.meta.last_page?n:void 0}}),f=d.status,m=d.data,g=d.error,y=d.isFetching,v=d.isFetchingNextPage,h=d.isFetchingPreviousPage,P=d.fetchNextPage,q=d.fetchPreviousPage,b=d.hasNextPage,x=d.hasPreviousPage;return A(e),/*#__PURE__*/E.default.createElement("div",null,"loading"===f?/*#__PURE__*/E.default.createElement("p",null,"Loading..."):"error"===f?/*#__PURE__*/E.default.createElement("span",null,"Error: ",g.message):/*#__PURE__*/E.default.createElement(n.Fragment,null,e.page>1&&/*#__PURE__*/E.default.createElement(l.Button,{className:"mb-6",onClick:function(){return q()},disabled:!x||h},h?"Loading more...":x?"Load Older":"Nothing more to load"),null==(a=m.pages)?void 0:a.map(function(a,r){/*#__PURE__*/return E.default.createElement(n.Fragment,{key:r},a.data.map(function(n,o){var c=s;return e.pagination===R&&e.threshold&&e.threshold>0&&e.threshold<=a.data.length&&a.data.length-e.threshold===o+1&&(c=u.InView),/*#__PURE__*/E.default.createElement(l.Box,{key:o,component:c,onChange:function(e,n){return function(e,n,a){e&&b&&!t.has(m,["pages",a+1])&&P()}(e,0,r)}},/*#__PURE__*/E.default.createElement(i,{serial:o+a.meta.from,data:n,meta:a.meta}))}))}),e.backToTop&&(null==(o=e.scrollPosition)?void 0:o.y)>400&&/*#__PURE__*/E.default.createElement(l.Button,{onClick:function(){p.scrollTo(document.querySelector(e.scrollTarget)||window,{top:0,duration:200})},className:"fixed",sx:{bottom:90,right:100,zIndex:100},variant:"outlined"},/*#__PURE__*/E.default.createElement("i",{className:"fa-solid fa-arrow-up-to-line mr-10"}),"Back to top"),/*#__PURE__*/E.default.createElement(l.Stack,{direction:"row",justifyContent:"center"},/*#__PURE__*/E.default.createElement(Y,{queryInfo:d,data:m,threshold:e.threshold})),y&&!v?/*#__PURE__*/E.default.createElement(l.Stack,{className:"mt-6",alignItems:"center",spacing:1},/*#__PURE__*/E.default.createElement("p",{className:"font-semibold"},"Background Updating..."),/*#__PURE__*/E.default.createElement(l.LinearProgress,{className:"w-full",color:"secondary"})):null))}function X(e){var t,n=e.renderListItem,a=e.renderList,u=F("queryKey"),o=r.useQuery(u,Q,{keepPreviousData:!0,staleTime:5e3}),i=o.isLoading,s=o.isSuccess,c=o.isFetching,f=o.error,m=o.data;return A(e),d.useUpdateEffect(function(){T.default(e.scrollTarget||window).scrollTop(0)},[m]),/*#__PURE__*/React.createElement(l.Stack,{spacing:1.5},i&&/*#__PURE__*/React.createElement(l.LinearProgress,null),(null==f?void 0:f.message)&&/*#__PURE__*/React.createElement(l.Alert,{variant:"filled",severity:"error"},null==f?void 0:f.message),s&&/*#__PURE__*/React.createElement(Fragment,null,/*#__PURE__*/React.createElement(a,{meta:null==m?void 0:m.meta},null==m||null==(t=m.data)?void 0:t.map(function(e,t){/*#__PURE__*/return React.createElement(n,{key:t,serial:m.meta.from+t,data:e,meta:null==m?void 0:m.meta})})),c&&/*#__PURE__*/React.createElement(l.LinearProgress,null)),(null==m?void 0:m.meta)&&/*#__PURE__*/React.createElement(Y,{meta:m.meta,size:e.perPage,sizes:e.sizes}))}function H(e,t){return void 0===t&&(t="0,0"),N.default(e).format(t)}Y.propTypes={type:P.default.oneOfType([P.default.string,P.default.func])},Y.types=((V={}).simple=D,V.links=function(e){var n=e.meta,a=F("setPage"),r=g.usePagination({count:null==n?void 0:n.last_page,onChange:function(e,t){return a(t)}}),u=t.filter(r.items,function(e){return t.includes(["previous","next"],e.type)});/*#__PURE__*/return React.createElement("nav",null,/*#__PURE__*/React.createElement(l.List,null,u.map(function(e,t){var n=e.type,a=z(e,G);/*#__PURE__*/return React.createElement(l.Button,S({type:"button"},a,{key:t}),n)})))},V.advanced=U,V[w]=function(e){var t=e.queryInfo||{},n=t.isFetchingNextPage,a=t.fetchNextPage,r=t.hasNextPage;return r?/*#__PURE__*/React.createElement(l.Button,{variant:"outlined",onClick:function(){return a()},disabled:!r||n},n?"Loading more...":"Load More"):"Nothing more to load"},V[R]=function(e){var t=e.threshold,n=e.queryInfo||{},a=n.isFetchingNextPage,r=n.fetchNextPage,o=n.hasNextPage;return o?a?/*#__PURE__*/E.default.createElement(l.LinearProgress,{className:"w-full mt-12",color:"secondary"}):t?null:/*#__PURE__*/E.default.createElement(l.Stack,{alignItems:"center"},/*#__PURE__*/E.default.createElement(u.InView,{as:l.Button,onClick:function(){return r()},disabled:!o||a,onChange:function(e){return e&&o&&r()}},"Load More")):"Nothing more to load"},V);var W=["children","meta"];function Z(e){var a,r,u,l,o,i,s,c,f,m,g=(r=(a=e).scrollTarget,u=a.scrollIndex,o=void 0===(l=a.wait)?300:l,i=n.useRef(),c=(s=d.useRafState({x:0,y:0}))[0],f=s[1],m=n.useCallback(function(e){var t=r?{x:"scrollLeft",y:"scrollTop"}:{x:"pageXOffset",y:"pageYOffset"};f({x:i.current[t.x],y:i.current[t.y]})},[r]),n.useEffect(function(){return i.current=r?document.querySelector(r):window,i.current.addEventListener("scroll",t.debounce(m,o)),function(){i.current.removeEventListener("scroll",m)}},[]),n.useEffect(function(){setTimeout(function(){console.log(r),scrollTo(T.default(r).get(0))},1e3)},[u]),c);/*#__PURE__*/return E.default.createElement(B,{createStore:K},t.includes([w,R],e.pagination)?/*#__PURE__*/E.default.createElement(J,S({},e,{scrollPosition:g})):/*#__PURE__*/E.default.createElement(X,S({},e,{scrollPosition:g})))}Z.propTypes={queryKey:P.default.string,url:P.default.oneOfType([P.default.string,P.default.object]),pagination:P.default.oneOfType([P.default.string,P.default.func]),page:P.default.oneOfType([P.default.string,P.default.number]),perPage:P.default.oneOfType([P.default.string,P.default.number]),select:P.default.func,threshold:P.default.number,scrollTop:P.default.bool,scrollTarget:P.default.string},Z.defaultProps={pagination:I,page:1,perPage:10,renderListItem:function(e){/*#__PURE__*/return React.createElement("div",null,e.serial,") ",e.data.id)},renderList:function(e){var t=e.children,n=e.meta;return z(e,W),/*#__PURE__*/React.createElement(l.Stack,{spacing:1},/*#__PURE__*/React.createElement("div",null,"Kết quả từ ",H(n.from),"-",H(n.to)," trong số"," ",H(n.total)),/*#__PURE__*/React.createElement(l.Stack,{spacing:2,divider:/*#__PURE__*/React.createElement(l.Divider,{orientation:"horizontal"}),sx:{py:2}},t))},backToTop:!1},e.ADVANCED="advanced",e.INFINITE_LOADING=R,e.LINKS="links",e.LOAD_MORE=w,e.PAGINATION_TYPES=O,e.QueryList=Z,e.SIMPLE=I});
//# sourceMappingURL=index.umd.js.map
