var e=require("lodash"),t=require("react"),n=require("prop-types"),r=require("@tanstack/react-query"),a=require("react-intersection-observer"),l=require("@mui/material"),u=require("zustand-store-addons"),o=require("zustand/context"),i=require("zustand/shallow"),s=require("immer"),c=require("react-use"),d=require("jquery"),f=require("axios"),m=require("@mui/lab"),g=require("scroll-js"),p=require("numeral");function y(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var v,h=/*#__PURE__*/y(t),E=/*#__PURE__*/y(n),P=/*#__PURE__*/y(u),q=/*#__PURE__*/y(o),x=/*#__PURE__*/y(i),k=/*#__PURE__*/y(s),w=/*#__PURE__*/y(d),L=/*#__PURE__*/y(f),N=/*#__PURE__*/y(p),T=((v={}).simple="Simple",v.links="Links",v.advanced="Advanced",v["load-more"]="Load More",v["infinite-loading"]="Infinite Loading",v);function b(){return b=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},b.apply(this,arguments)}function I(e,t){if(null==e)return{};var n,r,a={},l=Object.keys(e);for(r=0;r<l.length;r++)t.indexOf(n=l[r])>=0||(a[n]=e[n]);return a}var S=function(){return P.default(function(e,t){return{pagination:"simple",queryKey:[],init:function(t){var n=[t.queryKey,{url:t.url}];console.log(n),e({queryKey:n,pagination:t.pagination,selected:!1})},selected:!1,setSelected:function(t){return e({selected:t})},setPage:function(t){return e(k.default(function(e){e.queryKey[1].params.page=t}))},setPerPage:function(t){return e(k.default(function(e){e.queryKey[1].params.perPage=t}))}}},{computed:{perPage:function(){return e.get(this.queryKey,"1.params.perPage")},page:function(){return e.get(this.queryKey,"1.params.page")}}})},O=q.default(),C=O.Provider,R=function(e,t){return O.useStore.apply(O,K(e,t))},K=function(e,t){if("string"==typeof e){if(-1!==e.indexOf(",")){var n=e.split(",").map(function(e){return e.trim()});return[function(e){return n.map(function(t){return e[t]})},x.default]}return[function(t){return t[e]},t]}return[e,t]},B=function(n){var a=r.useQueryClient(),l=R("queryKey, init"),u=l[0],o=l[1];t.useEffect(function(){!e.isEmpty(u)&&a.cancelQueries(u),o(n)},[JSON.stringify(n.queryKey),n.url,n.page,n.perPage])},z=["url","params"],F=function(t){var n=t.pageParam,r=t.queryKey,a=t.signal;try{var l=r[1],u=l.url,o=l.params,i=(I(l,z),e.isString(u)?b({method:"get",url:u},o):b({params:b({},o,null==u?void 0:u.params)},u));return e.isUndefined(n)||(i.params.page=n),Promise.resolve(L.default(b({signal:a},i))).then(function(e){return e.data})}catch(e){return Promise.reject(e)}};function j(e){var t=e.meta,n=R("setPage");/*#__PURE__*/return h.default.createElement(l.Pagination,{variant:"outlined",showFirstButton:!0,showLastButton:!0,onChange:function(e,t){return n(t)},count:null==t?void 0:t.last_page,page:null==t?void 0:t.current_page})}function _(n){var r=n.meta,a=n.sizes,u=n.size,o=R("perPage, setPerPage, setPage"),i=o[0],s=o[1],c=o[2],d=null==r?void 0:r.last_page,f=null==r?void 0:r.current_page,m=function(e){var t=parseInt(e.target.value);("Enter"===e.key||"blur"===e.type)&&t>0&&t!==f&&(t<=d?c(t):alert("Not found page "+t))},g=t.useMemo(function(){return e.flow([e.uniq,e.sortBy])(a.concat(u))},[a,u]);return console.log(g),/*#__PURE__*/h.default.createElement(l.Stack,{direction:"row",spacing:2,alignItems:"center",justifyContent:"center"},/*#__PURE__*/h.default.createElement(l.Pagination,{variant:"outlined",showFirstButton:!0,showLastButton:!0,shape:"rounded",onChange:function(e,t){return c(t)},count:d,page:f}),/*#__PURE__*/h.default.createElement(l.TextField,{select:!0,label:"Size",value:i,onChange:function(e){return s(parseInt(e.target.value))},size:"small",style:{width:110}},g.map(function(e,t){/*#__PURE__*/return h.default.createElement(l.MenuItem,{key:t,value:e,defaultValue:!0},e," / page")})),/*#__PURE__*/h.default.createElement(l.Typography,null,"Go to"),/*#__PURE__*/h.default.createElement(l.TextField,{label:"Page",variant:"outlined",onKeyUp:m,onBlur:m,size:"small",type:"number",style:{width:85}}))}_.defaultProps={sizes:[10,20,50,100,200]};var M,A=["page","type","selected"];function D(n){var r,a=R("pagination"),l="function"==typeof(r=a)&&t.isValidElement(r())?a:e.get(D.types,a,j);/*#__PURE__*/return h.default.createElement(l,n)}D.propTypes={type:E.default.oneOfType([E.default.string,E.default.func])},D.types=((M={}).simple=j,M.links=function(t){var n=t.meta,r=R("setPage"),a=m.usePagination({count:null==n?void 0:n.last_page,onChange:function(e,t){return r(t)}}),u=e.filter(a.items,function(t){return e.includes(["previous","next"],t.type)});/*#__PURE__*/return h.default.createElement("nav",null,/*#__PURE__*/h.default.createElement(l.List,null,u.map(function(e,t){var n=e.type,r=I(e,A);/*#__PURE__*/return h.default.createElement(l.Button,b({type:"button"},r,{key:t}),n)})))},M.advanced=_,M["load-more"]=function(e){var t=e.queryInfo||{},n=t.isFetchingNextPage,r=t.fetchNextPage,a=t.hasNextPage;return a?/*#__PURE__*/h.default.createElement(l.Button,{variant:"outlined",onClick:function(){return r()},disabled:!a||n},n?"Loading more...":"Load More"):"Nothing more to load"},M["infinite-loading"]=function(e){var t=e.threshold,n=e.queryInfo||{},r=n.isFetchingNextPage,u=n.fetchNextPage,o=n.hasNextPage;return o?r?/*#__PURE__*/h.default.createElement(l.LinearProgress,{className:"w-full mt-12",color:"secondary"}):t?null:/*#__PURE__*/h.default.createElement(l.Stack,{alignItems:"center"},/*#__PURE__*/h.default.createElement(a.InView,{as:l.Button,onClick:function(){return u()},disabled:!o||r,onChange:function(e){return e&&o&&u()}},"Load More")):"Nothing more to load"},M);var Q=t.forwardRef(function(n,u){var o,i,s=n.renderListItem,c=n.renderList,d=n.wrapperListItem,f=n.onRowClicked,m=R("queryKey, selected, setSelected"),p=m[1],y=m[2],v=r.useInfiniteQuery(m[0],F,{getPreviousPageParam:function(e,t){var n=e.meta.current_page-1;return n>0?n:void 0},getNextPageParam:function(e,t){var n=e.meta.current_page+1;return n<=e.meta.last_page?n:void 0}}),E=v.status,P=v.data,q=v.error,x=v.isFetching,k=v.isFetchingNextPage,w=v.isFetchingPreviousPage,L=v.fetchNextPage,N=v.fetchPreviousPage,T=v.hasNextPage,I=v.hasPreviousPage;B(n);var S=t.useMemo(function(){return e.get(P,"pages.0.data.0")},[e.get(P,"pages.0.data.0")]);return t.useEffect(function(){},[]),/*#__PURE__*/h.default.createElement("div",null,"loading"===E?/*#__PURE__*/h.default.createElement(l.LinearProgress,{className:"w-full",color:"primary"}):"error"===E?/*#__PURE__*/h.default.createElement("span",null,"Error: ",q.message):/*#__PURE__*/h.default.createElement(t.Fragment,null,n.page>1&&/*#__PURE__*/h.default.createElement(l.Button,{className:"mb-6",onClick:function(){return N()},disabled:!I||w},w?"Loading more...":I?"Load Older":"Nothing more to load"),/*#__PURE__*/h.default.createElement(c,{meta:null==P?void 0:P.meta,firstRow:S,aaa:123},null==(o=P.pages)?void 0:o.map(function(r,u){/*#__PURE__*/return h.default.createElement(t.Fragment,{key:u},r.data.map(function(t,o){var i=o+r.meta.from,c={serial:i,data:t,meta:r.meta,onRowClicked:function(e,t){var n=p!==i&&i;y(n),f(e,{item:t,selected:n})},selected:i===p,setSelected:y};return d?/*#__PURE__*/h.default.createElement(l.Box,{key:o,component:"infinite-loading"===n.pagination&&n.threshold&&n.threshold>0&&n.threshold<=r.data.length&&r.data.length-n.threshold===o+1?a.InView:l.Box,onChange:function(t,n){return function(t,n,r){t&&T&&!e.has(P,["pages",r+1])&&L()}(t,0,u)}},/*#__PURE__*/h.default.createElement(s,c)):/*#__PURE__*/h.default.createElement(s,b({key:o},c))}))})),n.backToTop&&(null==(i=n.scrollPosition)?void 0:i.y)>400&&/*#__PURE__*/h.default.createElement(l.Button,{onClick:function(){g.scrollTo(document.querySelector(n.scrollTarget)||window,{top:0,duration:200})},className:"fixed",sx:{bottom:90,right:100,zIndex:100},variant:"outlined"},/*#__PURE__*/h.default.createElement("i",{className:"fa-solid fa-arrow-up-to-line mr-10"}),"Back to top"),/*#__PURE__*/h.default.createElement(l.Stack,{direction:"row",justifyContent:"center"},/*#__PURE__*/h.default.createElement(D,{queryInfo:v,data:P,threshold:n.threshold})),x&&!k?/*#__PURE__*/h.default.createElement(l.Stack,{className:"mt-6",alignItems:"center",spacing:1},/*#__PURE__*/h.default.createElement("p",{className:"font-semibold"},"Background Updating..."),/*#__PURE__*/h.default.createElement(l.LinearProgress,{className:"w-full",color:"primary"})):null))});Q.defaultProps={wrapperListItem:!0};var V=Q;function U(n){var a,u=n.renderListItem,o=n.renderList,i=n.onRowClicked,s=R("queryKey, selected, setSelected"),d=s[1],f=s[2],m=r.useQuery(s[0],F,{keepPreviousData:!0,staleTime:5e3}),g=m.isLoading,p=m.isSuccess,y=m.isFetching,v=m.error,E=m.data;B(n),c.useUpdateEffect(function(){w.default(n.scrollTarget||window).scrollTop(0)},[E]);var P=t.useMemo(function(){return e.get(E,"data.0")},[e.get(E,"data.0")]);/*#__PURE__*/return h.default.createElement(l.Stack,{spacing:1.5},g&&/*#__PURE__*/h.default.createElement(l.LinearProgress,null),(null==v?void 0:v.message)&&/*#__PURE__*/h.default.createElement(l.Alert,{variant:"filled",severity:"error"},null==v?void 0:v.message),p&&/*#__PURE__*/h.default.createElement(t.Fragment,null,/*#__PURE__*/h.default.createElement(o,{meta:null==E?void 0:E.meta,firstRow:P},null==E||null==(a=E.data)?void 0:a.map(function(e,t){var n=E.meta.from+t;/*#__PURE__*/return h.default.createElement(u,{key:t,serial:E.meta.from+t,data:e,meta:null==E?void 0:E.meta,onRowClicked:function(t,r){var a=d!==n&&n;f(a),i(t,{item:e,selected:a})}})})),y&&/*#__PURE__*/h.default.createElement(l.LinearProgress,null)),(null==E?void 0:E.meta)&&/*#__PURE__*/h.default.createElement(D,{meta:E.meta,size:n.perPage,sizes:n.sizes}))}function G(e,t){return void 0===t&&(t="0,0"),N.default(e).format(t)}var Y=["children","meta"],J=t.forwardRef(function(n,r){var a=function(n){var r=n.scrollTarget,a=n.scrollIndex,l=n.wait,u=void 0===l?300:l,o=t.useRef(),i=c.useRafState({x:0,y:0}),s=i[0],d=i[1],f=t.useCallback(function(e){var t=r?{x:"scrollLeft",y:"scrollTop"}:{x:"pageXOffset",y:"pageYOffset"};d({x:o.current[t.x],y:o.current[t.y]})},[r]);return t.useEffect(function(){return o.current=r?document.querySelector(r):window,o.current.addEventListener("scroll",e.debounce(f,u)),function(){o.current.removeEventListener("scroll",f)}},[]),t.useEffect(function(){setTimeout(function(){scrollTo(w.default(r).get(0))},1e3)},[a]),s}(n),l=b({},n,{scrollPosition:a});/*#__PURE__*/return h.default.createElement(C,{createStore:S},e.includes(["load-more","infinite-loading"],n.pagination)?/*#__PURE__*/h.default.createElement(V,b({ref:r},l)):/*#__PURE__*/h.default.createElement(U,b({ref:r},l)))});J.propTypes={queryKey:E.default.oneOfType([E.default.string,E.default.array]),url:E.default.oneOfType([E.default.string,E.default.object]),pagination:E.default.oneOfType([E.default.string,E.default.func]),page:E.default.oneOfType([E.default.string,E.default.number]),perPage:E.default.oneOfType([E.default.string,E.default.number]),select:E.default.func,threshold:E.default.number,scrollTop:E.default.bool,scrollTarget:E.default.string},J.defaultProps={pagination:"simple",page:1,perPage:10,renderListItem:function(e){/*#__PURE__*/return React.createElement("div",null,e.serial,") ",e.data.id)},renderList:function(e){var t=e.children,n=e.meta;return I(e,Y),/*#__PURE__*/React.createElement(l.Stack,{spacing:1},/*#__PURE__*/React.createElement("div",null,"Kết quả từ ",G(n.from),"-",G(n.to)," trong số"," ",G(n.total)),/*#__PURE__*/React.createElement(l.Stack,{spacing:2,divider:/*#__PURE__*/React.createElement(l.Divider,{orientation:"horizontal"}),sx:{py:2}},t))},backToTop:!1,onRowClicked:function(){}};var X=J;exports.ADVANCED="advanced",exports.INFINITE_LOADING="infinite-loading",exports.LINKS="links",exports.LOAD_MORE="load-more",exports.PAGINATION_TYPES=T,exports.QueryList=X,exports.SIMPLE="simple";
//# sourceMappingURL=index.js.map
